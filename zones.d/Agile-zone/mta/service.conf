#service configuration of mta

apply Service "SMTP:IPv4_availability" {
        import "generic-service"
        display_name = "SMTP:IPv4_availability" 
        check_command = "smtp_send"
        vars.nrpe_no_ssl = false
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = ["supervision@mail.comcast.net","supervision@mail.comcast.net","TEST BODY","Subject: Hello world","10","30"]
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
}

#apply Service "SMTP:SA7_availability" {
#        import "generic-service"
#        display_name = "SMTP:SA7_availability"
#        check_command = "smtp"
#        vars.nrpe_no_ssl = true
#	vars.nrpe_command = "helo $HOSTADDRESS$"
#        vars.nrpe_timeout = 240
#        vars.nrpe_timeout_unknown = true
#        vars.nrpe_arguments = ["587","5","10"]
#}

apply Service "SMTPS:CERTIFICATE_status" {
        import "generic-service"
        display_name = "SMTPS:CERTIFICATE_status"
        check_command = "ssl"
        vars.nrpe_no_ssl = false
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-omta" in host.groups
}

apply Service "BIZANGA:MMAP_errors" {
        import "generic-service"
        display_name = "BIZANGA:MMAP_errors"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_logfiles_bzmmap"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
}

apply Service "BIZANGA:IMP_restarts" {
        import "generic-service"
        display_name = "BIZANGA:IMP_restarts"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_logfiles_bzimprestart"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
}

apply Service "BIZANGA:INIT_errors" {
        import "generic-service"
        display_name = "BIZANGA:INIT_errors"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_logfiles_bzinit"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
}

apply Service "BIZANGA:BIZCE_memory_usage" {
        import "generic-service"
        display_name = "BIZANGA:BIZCE_memory_usage"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_proc_res_usg"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = ["7500000","8000000","bizce","VSZ"]
        assign where "res-rmta" in host.groups
}

apply Service "BIZANGA:NBOPEN_status" {
        import "generic-service"
        display_name = "BIZANGA:NBOPEN_status"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_nbopen"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
}


apply Service "BIZANGA:NCMEC_errors" {
        import "generic-service"
        display_name = "BIZANGA:NCMEC_errors"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_logfiles_bzncmec"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
}

apply Service "OS:FS_mounts" {
        import "generic-service"
        display_name = "OS:FS_mounts"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_mounts"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
        assign where "res-rmta" in host.groups
}

apply Service "SSH" {
        import "generic-service"
        display_name = "SSH"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
        assign where "res-rmta" in host.groups
}

apply Service "OS:IPTABLES_status" {
        import "generic-service"
        display_name = "OS:IPTABLES_status"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_iptables"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
        assign where "res-rmta" in host.groups
}

apply Service "PROCESSING:AUTHENGINE_avg" {
        import "generic-service"
        display_name = "PROCESSING:AUTHENGINE_avg"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.2.2.6.1.0","AUTHENGINE_avg","160000000","260000000"]
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
}

apply Service "PROCESSING:SENDERPOLICY_avg" {
        import "generic-service"
        display_name = "PROCESSING:SENDERPOLICY_avg"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.2.1.6.1","SenderPolicy_Avg","3200000","5000000"]
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
}

apply Service "PROCESSING:NCMEC_avg" {
        import "generic-service"
        display_name = "PROCESSING:NCMEC_avg"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.2.4.6.1","NCMEC_Avg","4000000","5000000"]
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
}

apply Service "CONNECTIONS:inbound" {
        import "generic-service"
        display_name = "CONNECTIONS:inbound"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_msg"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.6.3.1.1.3","inbound_connections","10","0"]
	assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups

}

apply Service "MESSAGES:DELIVERY_process_avg" {
        import "generic-service"
        display_name = "MESSAGES:DELIVERY_process_avg"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = ["MESSAGES:DELIVERY_process_avg","msg_delivery_process_avg","500","1000"]
        assign where "res-imta" in host.groups
	assign where "res-qmta" in host.groups
	assign where "res-zmta" in host.groups
}

apply Service "MESSAGES:DELIVERY_process_avg" {
        import "generic-service"
        display_name = "MESSAGES:DELIVERY_process_avg"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.7.2.1.1.0","msg_delivery_process_avg","2","12"]
        assign where "res-omta" in host.groups
}

apply Service "OS:FS_mount_/mnt/queue_8k" {
        import "generic-service"
        display_name = "OS:FS_mount_/mnt/queue_8k"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_queue_mount"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
}

apply Service "BIZANGA:sys_errors" {
        import "generic-service"
        display_name = "BIZANGA:sys_errors"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_logfiles_bzerrors"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
	assign where "res-qmta" in host.groups
}

apply Service "MTA-Default_Gateway:PO" {
        import "generic-service"
        display_name = "MTA-Default_Gateway:PO"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "MTA_PO_check_gateway"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-omta-po" in host.groups
	assign where "res-imta-po" in host.groups
}

apply Service "MTA-Default_Gateway:CH2" {
        import "generic-service"
        display_name = "MTA-Default_Gateway:CH2"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "MTA_CH2_check_gateway"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-omta-ch2" in host.groups
	assign where "res-imta-ch2" in host.groups
}

apply Service "MTA:FD_Utilization" {
        import "generic-service"
        display_name = "MTA:FD_Utilization"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_fd_count"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = ["90","85","root"]
        assign where "res-mta" in host.groups
}

apply Service "MTA:Deleted_process" {
        import "generic-service"
        display_name = "MTA:Deleted_process"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_deleted_process"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-mta" in host.groups
}

apply Service "SMTP:SESSIONS_inbound_avg_imta" {
        import "generic-service"
        display_name = "SMTP:SESSIONS_inbound_avg_imta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.6.3.1.1.1","inbound_smtp_session_avt","1500","3000"]
        assign where "res-imta" in host.groups
}

apply Service "SMTP:SESSIONS_inbound_avg_omta" {
        import "generic-service"
        display_name = "SMTP:SESSIONS_inbound_avg_omta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.6.3.1.1.1","inbound_smtp_session_avt","6500","12000"]
        assign where "res-omta" in host.groups
}

apply Service "SMTP:SESSIONS_inbound_avg_zmta_qmta" {
        import "generic-service"
        display_name = "SMTP:SESSIONS_inbound_avg_zmta_qmta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.6.3.1.1.1","inbound_smtp_session_avt","120000","160000"]
        assign where "res-zmta" in host.groups
	assign where "res-qmta" in host.groups
}

apply Service "MESSAGES:QUEUE_delivery_imta_omta" {
        import "generic-service"
        display_name = "MESSAGES:QUEUE_delivery_imta_omta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.3.4.4.2.0","msg_delivery_queue","1000","2500"]
        assign where "res-imta" in host.groups
	assign where "res-omta" in host.groups
}

apply Service "MESSAGES:QUEUE_delivery_zmta_qmta" {
        import "generic-service"
        display_name = "MESSAGES:QUEUE_delivery_zmta_qmta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.3.4.4.2.0","msg_delivery_queue","2500","5000"]
        assign where "res-zmta" in host.groups
	assign where "res-qmta" in host.groups
}

apply Service "MESSAGES:QUEUE_workflow_imta" {
        import "generic-service"
        display_name = "MESSAGES:QUEUE_workflow_imta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.3.4.4.4","msg_workflow_queue","10000","20000"]
        assign where "res-imta" in host.groups
}

apply Service "MESSAGES:QUEUE_workflow_omta" {
        import "generic-service"
        display_name ="MESSAGES:QUEUE_workflow_omta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.3.4.4.4","msg_workflow_queue","5000","10000"]
        assign where "res-omta" in host.groups
}

apply Service "MESSAGES:QUEUE_workflow_zmta" {
        import "generic-service"
        display_name = "MESSAGES:QUEUE_workflow_zmta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.3.4.4.4","msg_workflow_queue","2500","5000"]
        assign where "res-zmta" in host.groups
}

apply Service "MESSAGES:QUEUE_workflow_qmta" {
        import "generic-service"
        display_name = "MESSAGES:QUEUE_workflow_qmta"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_avt"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = [".1.3.6.1.4.1.25194.1.2.3.4.4.4","msg_workflow_queue","2500","5000"]
        assign where "res-qmta" in host.groups
}

apply Service "Partition:VAR" {
        import "generic-service"
        display_name = "Partition:VAR"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
	vars.nrpe_command = "check_var_mta"
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "res-mta" in host.groups
}

