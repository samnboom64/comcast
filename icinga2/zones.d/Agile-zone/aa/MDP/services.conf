#MDP service description

apply Service "MDP-HTTPS_Port" {
        import "generic-service"
        display_name ="MDP-HTTPS_Port"
        check_command ="tcp"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port = 443
        assign where "mdp-https" in host.groups
}

apply Service "MDP-SSH_Port" {
        import "generic-service"
        display_name ="MDP-SSH_Port"
        check_command ="tcp"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port = 22
        assign where "mdp-ssh" in host.groups
}

apply Service "MDP-PING_CHECK" {
        import "generic-service"
        display_name ="MDP-PING_CHECK"
        check_command="ping"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "mdp-ping" in host.groups
}

apply Service "MDP-SMTP_CHECK" {
        import "generic-service"
        display_name ="MDP-SMTP_CHECK"
        check_command ="tcp"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port = 25
        assign where "mdp-smtp" in host.groups
}

apply Service "MDP-SMTP2_CHECK" {
        import "generic-service"
        display_name ="MDP-SMTP2_CHECK"
        check_command ="tcp"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port = 1025
        assign where "mdp-smtp2" in host.groups
}

apply Service "MDP-SMTP3_CHECK" {
        import "generic-service"
        display_name ="MDP-SMTP3_CHECK"
        check_command ="tcp"
        vars.nrpe_no_ssl =true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port = 2025
        assign where "mdp-smtp3" in host.groups
}

apply Service "MDP-SMTP4_CHECK" {
        import "generic-service"
        display_name ="MDP-SMTP4_CHECK"
        check_command =tcp
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port =3025
        assign where "mdp-smtp4" in host.groups
}

apply Service "MDP-LDAP_Ports" {
        import "generic-service"
        display_name ="AA-DNSBL-RBLDNSD_Service"
        check_command ="tcp"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port =587
        assign where "mdp-ldap" in host.groups
}

apply Service "SMTP-POP_Test" {
        import "generic-service"
        display_name ="SMTP-POP_Test"
        check_command =pending
        vars.nrpe_no_ssl = pending
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.tcp_port =587
        assign where "mdp-smtp" in host.groups
}

apply Service "CPU_load" {
        import "generic-service"
        display_name ="CPU_load"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_load"
        assign where "mdp" in host.groups
}

apply Service "data-log_partition" {
        import "generic-service"
        display_name ="data-log partition"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_data"
        assign where "mdp" in host.groups
}

apply Service "mnt/queue" {
        import "generic-service"
        display_name ="mnt/queue"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
	vars.nrpe_arguments = "check_queue"
        assign where "mdp" in host.groups
}

apply Service "boot_partition" {
        import "generic-service"
        display_name ="boot_partition"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_boot"
        assign where "mdp" in host.groups
}

apply Service "root_partition" {
        import "generic-service"
        display_name ="root_partition"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_root"
        assign where "mdp" in host.groups
}

apply Service "Bizimp_Processes_OMTA" {
        import "generic-service"
        display_name ="Bizimp_Processes_OMTA"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_bizimp"
        assign where "mdp-bizimp" in host.groups
}

apply Service "Swap_Usage" {
        import "generic-service"
        display_name ="Swap_Usage"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_swap"
        assign where "mdp" in host.groups
}

apply Service "Memory_Usage" {
        import "generic-service"
        display_name ="Memory_Usage"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_mem"
        assign where "mdp" in host.groups
}

apply Service "System.log_Reporting_with_Exclude" {
        import "generic-service"
        display_name ="System.log_Reporting_with_Exclude"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_syslog_exclude"
        assign where "mdp-bizimp" in host.groups
        assign where "mdp-bizaqm" in host.groups
}

apply Service "Conntrack_Reporting_to_IMP" {
        import "generic-service"
        display_name ="Conntrack_Reporting_to_IMP"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_conntrack"
        assign where "mdp-bizimp" in host.groups
}


apply Service "Conntrack_Reporting_to_AQM" {
        import "generic-service"
        display_name ="Conntrack_Reporting_to_AQM"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_conntrack"
        assign where "mdp-bizaqm" in host.groups
}

apply Service "Bizimp_Processes_QMTA" {
        import "generic-service"
        display_name ="Bizimp_Processes_QMTA"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_bizaqm"
        assign where "mdp-bizaqm" in host.groups
}

apply Service "Application.log_Checking" {
        import "generic-service"
        display_name ="Application.log_Checking"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_applog"
        assign where "mdp-bizimp" in host.groups
}

apply Service "MDP_LDAP_DXServer_Process" {
        import "generic-service"
        display_name ="MDP_LDAP_DXServer_Process"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_dxserver"
        assign where "mdp-ldap" in host.groups
}

apply Service "MDP_Raid_Array_Health" {
        import "generic-service"
        display_name ="MDP Raid Array Health"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_hpraid"
        assign where "mdp-raid" in host.groups
}

apply Service "MDP_Fan_Operation_Check" {
        import "generic-service"
        display_name ="MDP_Fan_Operation_Check"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        assign where "mdp" in host.groups
}

apply Service "MDP_PSU_Operation_Check" {
        import "generic-service"
        display_name ="MDP_PSU_Operation_Check"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_psus"
        assign where "mdp" in host.groups
}

apply Service "MDP_NTP_time_check" {
        import "generic-service"
        display_name ="MDP_NTP_time_check"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_ntp_time"
        assign where "mdp" in host.groups
}

apply Service "MDP_LDAP_Data_Check" {
        import "generic-service"
        display_name ="MDP_LDAP_Data_Check"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_mdp_errors"
        assign where "mdp" in host.groups
}

apply Service "MDP_iptables_check" {
        import "generic-service"
        display_name ="MDP_iptables_check"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_iptables"
        assign where "mdp" in host.groups
}

apply Service "Read_Only_Mount_Check" {
        import "generic-service"
        display_name ="Read_Only_Mount_Check"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "check_ro_mounts"
        assign where "mdp" in host.groups
}

apply Service "ZIMBRA:LICENSE" {
        import "generic-service"
        display_name ="ZIMBRA:LICENSE"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "zimbra_license"
	assign where host.name in ["csp-ms01.chicago.il.bo.comcast.net"]
}

apply Service "ZIMBRA:LICENSE_activation" {
        import "generic-service"
        display_name ="ZIMBRA:LICENSE_activation"
        check_command ="nrpe"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 240
        vars.nrpe_timeout_unknown = true
        vars.nrpe_arguments = "zimbra_license_activation_status"
	assign where host.name in ["csp-ms01.chicago.il.bo.comcast.net"]
}


