/*
apply Service "IMAP:ACCESS_ipv4" {
        import "generic-service"
        display_name ="IMAP:ACCESS_ipv4"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv4_imap"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "host.name" ]
        assign where "zimbra8-iproxy" in host.groups
}
*/

apply Service "IMAP:ACCESS_ipv4" {
        import "generic-service"
        display_name ="IMAP:ACCESS_ipv4"
        check_command ="imap"
        vars.imap_port = 143
        vars.imap_timeout = 60
        vars.imap_address = "$check_address$"
        assign where "zimbra8-iproxy" in host.groups
}


apply Service " IMAP:ACCESS_ipv6_ch2" {
        import "generic-service"
        display_name =" IMAP:ACCESS_ipv6_ch2"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imap"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60", host.name ]
        assign where "zimbra8-iproxy-ch2" in host.groups
}

apply Service " IMAPS:ACCESS_ipv6_ch2" {
        import "generic-service"
        display_name =" IMAPS:ACCESS_ipv6_ch2"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imaps"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60", host.name]
        assign where "zimbra8-iproxy-ch2" in host.groups
}




apply Service " IMAP:ACCESS_ipv6_po" {
        import "generic-service"
        display_name =" IMAP:ACCESS_ipv6_po"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imap"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-po-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60", host.name ]
        assign where "zimbra8-iproxy-po" in host.groups
}



apply Service " IMAPS:ACCESS_ipv6_po" {
        import "generic-service"
        display_name =" IMAPS:ACCESS_ipv6_po"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imaps"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-po-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60" , host.name]
        assign where "zimbra8-iproxy-po" in host.groups
}




apply Service " IMAP:ACCESS_ipv6_ch2d" {
        import "generic-service"
        display_name =" IMAP:ACCESS_ipv6_ch2d"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imap"
        vars.nrpe_no_ssl = true
#        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60", host.name ]
        assign where "zimbra8-iproxy-ch2-d" in host.groups
}

apply Service " IMAPS:ACCESS_ipv6_ch2d" {
        import "generic-service"
        display_name =" IMAPS:ACCESS_ipv6_ch2d"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imaps"
        vars.nrpe_no_ssl = true
#        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60", host.name ]
        assign where "zimbra8-iproxy-ch2-d" in host.groups
}


apply Service " IMAP:ACCESS_ipv6_cmcd" {
        import "generic-service"
        display_name =" IMAP:ACCESS_ipv6_cmcd"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imap"
        vars.nrpe_no_ssl = true
#        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60", host.name]
        assign where "zimbra8-iproxy-cmcd" in host.groups
}

apply Service " IMAPS:ACCESS_ipv6_cmcd" {
        import "generic-service"
        display_name =" IMAPS:ACCESS_ipv6_cmcd"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_imaps"
        vars.nrpe_no_ssl = true
#        vars.nrpe_timeout = 60
        vars.nrpe_address = "resrbt-ch2-01v.sys.comcast.net"
        vars.nrpe_arguments = [ "120", "30", "60" , host.name]
        assign where "zimbra8-iproxy-cmcd" in host.groups
}


apply Service "IPROXY:LOG" {
        import "generic-service"
        display_name ="IPROXY:LOG"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_pprxy_z8_log"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
}



apply Service "METRICS:ZIMBRA8_mailbox" {
        import "generic-service"
        display_name ="METRICS:ZIMBRA8_mailbox"
        check_command ="nrpe8k"
        vars.nrpe_command = "file_reshproxy_server_metrics"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service "METRICS:ZIMBRA8_proxy" {
        import "generic-service"
        display_name ="METRICS:ZIMBRA8_proxy"
        check_command ="nrpe8k"
        vars.nrpe_command = "log_reshproxy_server_metrics"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}



apply Service "NET:connections" {
        import "generic-service"
        display_name ="NET:connections"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_all_conns_8k"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service "NET:iproxy_connections" {
        import "generic-service"
        display_name ="NET:iproxy_connections"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ss"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_arguments = [ "17000", "15000" ]
        assign where "zimbra8-iproxy" in host.groups
        
}

apply Service "NGNIX:WORKER_connections" {
        import "generic-service"
        display_name ="NGNIX:WORKER_connections"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_log_worker_conns"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}

apply Service "NRPE8k" {
        import "generic-service"
        display_name ="NRPE8k"
        check_command ="nrpe8k"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}

apply Service "NTWK:CONNECTIONS_ipv4" {
        import "generic-service"
        display_name ="NTWK:CONNECTIONS_ipv4"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv4_conns_8k"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service "NTWK:CONNECTIONS_ipv6" {
        import "generic-service"
        display_name ="NTWK:CONNECTIONS_ipv6"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_ipv6_conns_8k"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service "OS:FS_mounts" {
        import "generic-service"
        display_name ="OS:FS_mounts"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_mounts"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}



apply Service "OS:MEMORY_page_swap" {
        import "generic-service"
        display_name ="OS:MEMORY_page_swap"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_pgswp"
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
        assign where "zimbra8-aproxy" in host.groups
}


apply Service "PPROXY:Metric" {
        import "generic-service"
        display_name ="PPROXY:Metric"
        check_command ="nrpe8k"
        vars.nrpe_command = "pproxy_metric"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
}


apply Service "Proxy-Default_Gateway:CH2" {
        import "generic-service"
        display_name ="Proxy-Default_Gateway:CH2"
        check_command ="nrpe8k"
        vars.nrpe_command = "prxy_CH2_check_gateway"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy-ch2" in host.groups
        assign where "zimbra8-pproxy-ch2" in host.groups
        assign where "zimbra8-hproxy-ch2" in host.groups
        assign where "zimbra8-aproxy-ch2" in host.groups
}


apply Service "Proxy-Default_Gateway:CH2D" {
        import "generic-service"
        display_name ="Proxy-Default_Gateway:CH2D"
        check_command ="nrpe8k"
        vars.nrpe_command = "prxy_CH2D_check_gateway"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy-ch2-d" in host.groups
        assign where "zimbra8-pproxy-ch2-d" in host.groups
        assign where "zimbra8-hproxy-ch2-d" in host.groups
	assign where "zimbra8-aproxy-ch2-d" in host.groups
}

apply Service "Proxy-Default_Gateway:PO" {
        import "generic-service"
        display_name ="Proxy-Default_Gateway:PO"
        check_command ="nrpe8k"
        vars.nrpe_command = "prxy_PO_check_gateway"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy-po" in host.groups
        assign where "zimbra8-pproxy-po" in host.groups
        assign where "zimbra8-hproxy-po" in host.groups
	assign where "zimbra8-aproxy-po" in host.groups
}



apply Service "PROXY:CONNECTIONS_closewait" {
        import "generic-service"
        display_name ="PROXY:CONNECTIONS_closewait"
        check_command ="nrpe8k"
        vars.nrpe_command = "zimbra_cxn_closewait"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}

apply Service "PROXY:FD_Utilization" {
        import "generic-service"
        display_name ="PROXY:FD_Utilization"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_fd_count"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_arguments = [ "90", "85", "root" ]
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
        assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}

apply Service "PROXY:FD_Utilization_zimbra" {
        import "generic-service"
        display_name ="PROXY:FD_Utilization_zimbra"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_fd_count"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        vars.nrpe_arguments = [ "90", "85", "zimbra" ]
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
	assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service "PROXY:PORT_http_thread_saturation" {
        import "generic-service"
        display_name ="PROXY:PORT_http_thread_saturation"
        check_command ="nrpe8k"
        vars.nrpe_command = "zimbra8_http_threadsatcnt"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
	assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service " Zimbra Server Metrics" {
        import "generic-service"
        display_name =" Zimbra Server Metrics"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_zimbra_server_metrics_proxy"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
	assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}


apply Service " ZIMBRA:IMAP_counts" {
        import "generic-service"
        display_name =" ZIMBRA:IMAP_counts"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_imaps"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
}


apply Service "ZIMBRA:SERVICES" {
        import "generic-service"
        display_name ="ZIMBRA:SERVICES"
        check_command ="nrpe8k"
        vars.nrpe_command = "check_status_pprxyzimbra8"
        vars.nrpe_no_ssl = true
        vars.nrpe_timeout = 60
        assign where "zimbra8-iproxy" in host.groups
        assign where "zimbra8-pproxy" in host.groups
	assign where "zimbra8-hproxy" in host.groups
	assign where "zimbra8-aproxy" in host.groups
}
